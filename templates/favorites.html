{% extends "layout/base.html" %}
{% load static %}

{% block title %}Favorites{% endblock %}

{% block content %}
<div class="page-heading header-text">
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <h3>Favorites</h3>
        <span class="breadcrumb"><a href="{% url 'home' %}">Home</a> &gt; Favorites</span>
      </div>
    </div>
  </div>
</div>

<div class="section trending">
  <div class="container">
    <div class="row">
      {% for favorite in favorites %}
        <div class="col-lg-4 col-md-6 mb-4">
          <div class="item h-100">
            <a class="game-card-link" href="{% url 'product_detail' favorite.game.slug %}" aria-label="{{ favorite.game.title }}">
              <div class="thumb">
                {% with game=favorite.game %}
                  {% if game.primary_image_url %}
                    <img src="{{ game.primary_image_url }}" alt="{{ game.primary_image_alt }}">
                  {% else %}
                    <img src="{% static 'theme/assets/images/trending-01.jpg' %}" alt="{{ game.title }}">
                  {% endif %}
                {% endwith %}
              </div>
              <div class="down-content">
                <h4>{{ favorite.game.title }}</h4>
                <p>
                  {% if favorite.game.discount_percent > 0 %}
                    <span class="old-price">${{ favorite.game.price }}</span>
                    <span class="new-price">${{ favorite.game.discounted_price }}</span>
                    <span class="discount-badge">-{{ favorite.game.discount_percent }}%</span>
                  {% else %}
                    Price: ${{ favorite.game.price }}
                  {% endif %}
                </p>
                <p>Rating: {{ favorite.average_rating|default_if_none:"0"|floatformat:1 }}</p>
              </div>
            </a>
          </div>
        </div>
      {% empty %}
        <div class="col-lg-12">
          <p>No favorite games yet.</p>
        </div>
      {% endfor %}
    </div>
  </div>
</div>
{% endblock %}
